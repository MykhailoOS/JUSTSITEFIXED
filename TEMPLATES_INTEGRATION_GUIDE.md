# 🎯 Интеграция Templates с Конструктором

## 📋 Обзор интеграции

Система Templates теперь полностью интегрирована с конструктором сайтов! Пользователи могут:

- **Выбирать шаблоны** прямо из конструктора
- **Просматривать превью** перед вставкой
- **Вставлять шаблоны** в текущий проект
- **Настраивать данные** для шаблонов

## 🚀 Как это работает

### 1. Кнопка Templates в конструкторе
- В интерфейсе конструктора появилась новая кнопка **"Templates"** (иконка блока)
- Находится рядом с кнопками Save, Deploy, AI Helper
- При нажатии открывается модальное окно выбора шаблонов

### 2. Модальное окно выбора шаблонов
```
┌─────────────────────────────────────────┐
│ Choose Template                    ✕   │
├─────────────────────────────────────────┤
│ [Search...] [Category ▼] [Type ▼]      │
├─────────────────────────────────────────┤
│ ┌─────────┐ ┌─────────┐ ┌─────────┐    │
│ │Template1│ │Template2│ │Template3│    │
│ │Preview  │ │Preview  │ │Preview  │    │
│ │[Insert] │ │[Insert] │ │[Insert] │    │
│ └─────────┘ └─────────┘ └─────────┘    │
└─────────────────────────────────────────┘
```

### 3. Функции модального окна
- **Поиск**: Поиск по названию и описанию
- **Фильтры**: По категории (landing, blog, portfolio, etc.)
- **Типы**: По типу (html, component, layout)
- **Превью**: Просмотр шаблона перед вставкой
- **Вставка**: Добавление в текущий проект

## 🛠️ Техническая реализация

### API Endpoints
```
GET  /api/templates_constructor.php?action=list
GET  /api/templates_constructor.php?action=get&id={id}
GET  /api/templates_constructor.php?action=preview&id={id}
POST /api/templates_constructor.php (action: insert, render)
```

### Компоненты
- `components/template-selector.php` - Модальное окно выбора
- `api/templates_constructor.php` - API для интеграции
- Интеграция в `index.php` - Основной конструктор

### JavaScript функции
```javascript
// Показать селектор шаблонов
showTemplateSelector(projectId)

// Обработчик вставки шаблона
window.onTemplateInserted = function(html) {
    // Добавить HTML в канвас
}

// Получить ID текущего проекта
getCurrentProjectId()
```

## 🎨 Пользовательский интерфейс

### Кнопка Templates
- **Расположение**: В панели инструментов конструктора
- **Иконка**: Блок (block.svg)
- **Подсказка**: "Templates"
- **Функция**: Открывает модальное окно выбора

### Модальное окно
- **Размер**: Адаптивный (до 6xl на больших экранах)
- **Поиск**: Живой поиск по названию и описанию
- **Фильтры**: Dropdown для категории и типа
- **Сетка**: Адаптивная сетка шаблонов
- **Превью**: Модальное окно с тремя вкладками

### Вкладки превью
1. **Preview** - Визуальное превью шаблона
2. **Code** - Исходный HTML код
3. **Data** - JSON данные для шаблона

## 📊 Процесс вставки шаблона

### Шаг 1: Выбор шаблона
1. Пользователь нажимает кнопку "Templates"
2. Открывается модальное окно с списком шаблонов
3. Пользователь может искать и фильтровать шаблоны

### Шаг 2: Превью
1. Пользователь нажимает "Preview" на шаблоне
2. Открывается модальное окно превью
3. Показывается визуальное превью, код и данные

### Шаг 3: Вставка
1. Пользователь нажимает "Insert Template"
2. Шаблон вставляется в текущий проект
3. Показывается уведомление об успехе

## 🔧 Настройка данных шаблона

### Автоматические данные
- Система использует `sample_data` из шаблона
- Данные автоматически подставляются в переменные

### Пользовательские данные
```javascript
// Можно передать кастомные данные
insertTemplate(templateId, {
    title: "Мой заголовок",
    content: "Мой контент",
    featured: true
});
```

## 🎯 Примеры использования

### Пример 1: Вставка Hero Section
1. Нажать кнопку "Templates"
2. Найти "Hero Section" в списке
3. Нажать "Preview" для просмотра
4. Нажать "Insert Template"
5. Hero section добавится в проект

### Пример 2: Вставка Feature Cards
1. Открыть Templates
2. Фильтровать по категории "landing"
3. Выбрать "Feature Cards"
4. Вставить в проект
5. Карточки появятся на странице

## 🚨 Обработка ошибок

### Нет проекта
- Если проект не найден, показывается ошибка
- Система пытается получить ID из различных источников

### Ошибка загрузки
- Показывается уведомление об ошибке
- Пользователь может повторить попытку

### Ошибка вставки
- Показывается сообщение об ошибке
- Шаблон не вставляется в проект

## 🔄 Интеграция с существующими функциями

### Сохранение проекта
- Вставленные шаблоны сохраняются вместе с проектом
- HTML шаблонов становится частью контента проекта

### Экспорт проекта
- Шаблоны экспортируются как обычный HTML
- Все стили и скрипты сохраняются

### Редактирование
- Вставленные шаблоны можно редактировать как обычные элементы
- Поддерживается drag & drop и другие функции конструктора

## 🎉 Готово к использованию!

Теперь пользователи могут:
- ✅ Выбирать шаблоны из конструктора
- ✅ Просматривать превью перед вставкой
- ✅ Вставлять шаблоны в проекты
- ✅ Настраивать данные для шаблонов
- ✅ Использовать все функции Handlebars

**Система Templates полностью интегрирована с конструктором!** 🚀
